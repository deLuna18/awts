<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="/statics/index.css">
    <link rel="stylesheet" href="/statics/w3.css">
    <title>Candidates</title>
</head>
<body>
    <h1 class="w3-text-indigo">Candidates Management</h1>

    <h2>Add Candidate</h2>
    <form action="/candidates/add" method="POST" class="w3-box w3-padding">
        First Name: <input type="text" name="fname" required class="w3-input"><br>
        Middle Name: <input type="text" name="mname" class="w3-input"><br>
        Last Name: <input type="text" name="lname" required class="w3-input"><br>
        Position:
        <select name="pos" required class="w3-select">
            {# Only open positions are shown, as filtered in app.py #}
            {% for pos in positions %}
            <option value="{{ pos[0] }}">{{ pos[1] }}</option>
            {% endfor %}
        </select>
        Status:
        <select name="stat" class="w3-select">
            <option value="active">Active</option>
            <option value="inactive">Inactive</option>
        </select>
        <button type="submit" class="w3-button w3-indigo w3-margin-top">Add</button>
    </form>

    <h2>Existing Candidates</h2>
    <table class="w3-table-all w3-bordered w3-hoverable">
        <tr><th>ID</th><th>Full Name</th><th>Position</th><th>Status</th><th>Update</th></tr>
        {% for c in candidates %}
        <tr>
            <td>{{ c[0] }}</td>
            <td>{{ c[1] }} {{ c[2] }} {{ c[3] }}</td>
            <td>{{ c[4] }}</td>
            <td>{{ c[5] }}</td>
            <td>
                <form action="/candidates/update" method="POST">
                    <input type="hidden" name="cid" value="{{ c[0] }}">
                    First Name: <input type="text" name="fname" value="{{ c[1] }}" required class="w3-input">
                    Middle Name: <input type="text" name="mname" value="{{ c[2] }}" class="w3-input">
                    Last Name: <input type="text" name="lname" value="{{ c[3] }}" required class="w3-input">
                    Position:
                    <select name="pos" class="w3-select">
                        {% for pos in positions %}
                        <option value="{{ pos[0] }}">{{ pos[1] }}</option>
                        {% endfor %}
                    </select>
                    Status:
                    <select name="stat" class="w3-select">
                        <option value="active" {% if c[5] == 'active' %}selected{% endif %}>Active</option>
                        <option value="inactive" {% if c[5] == 'inactive' %}selected{% endif %}>Inactive</option>
                    </select>
                    <button type="submit">Update</button>
                </form>
                {% if c[5] == 'active' %}
                <form action="/candidates/deactivate" method="POST" style="display:inline">
                    <input type="hidden" name="cid" value="{{ c[0] }}">
                    <button type="submit">Deactivate</button>
                </form>
                {% else %}
                <form action="/candidates/activate" method="POST" style="display:inline">
                    <input type="hidden" name="cid" value="{{ c[0] }}">
                    <button type="submit">Activate</button>
                </form>
                {% endif %}
                <form action="/candidates/delete" method="POST" style="display:inline" onsubmit="return confirm('Delete this candidate?');">
                    <input type="hidden" name="cid" value="{{ c[0] }}">
                    <button type="submit">Delete</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>

    <br><a href="/" class="w3-button w3-light-grey">Back to Home</a>
</body>
</html>
